# ğŸµ Music Recommender System

Sistema de recomendaciÃ³n musical con RAG (Retrieval Augmented Generation) usando GCP.

## ğŸ“‹ Requisitos

- Python 3.11+
- Cuenta en GCP
- API keys: Spotify, Genius, Last.fm

## ğŸš€ Setup

### 1. Clonar proyecto
```bash
git clone <tu-repo>
cd music-recommender
```

### 2. Crear ambiente virtual
```bash
python -m venv venv
source venv/bin/activate  # Mac/Linux
venv\Scripts\activate     # Windows
```

### 3. Instalar dependencias
```bash
cd ingestion
pip install -r requirements.txt
```

### 4. Configurar .env
Copia `.env.example` a `.env` y llena las credenciales.

### 5. Autenticar en GCP
```bash
gcloud auth login
gcloud config set project music-recommender-dev
gcloud auth application-default login
```

## ğŸ“Š Estructura del Proyecto
```
music-recommender/
â”œâ”€â”€ ingestion/
â”‚   â”œâ”€â”€ clients/
â”‚   â”œâ”€â”€ processors/
â”‚   â”œâ”€â”€ storage/
â”‚   â””â”€â”€ utils/
â”œâ”€â”€ api/
â”œâ”€â”€ dbt/
â”œâ”€â”€ tests/
â””â”€â”€ logs/
```

## ğŸ“Š Estructura del Proyecto
```
ğŸ“ MUSIC-RECOMMENDER
  ğŸ“ ingestion
    ğŸ“ clients
    ğŸ“ processors
    ğŸ“ storage
    ğŸ“ utils
  ğŸ“ api
  ğŸ“ dbt
  ğŸ“ tests
  ğŸ“ logs
  ğŸ“„ .env
  ğŸ“„ .gitignore
  ğŸ“„ README.md


## ğŸ“Š VisiÃ³n General del Pipeline

APIs Externas â†’ Ingesta/ETL â†’ Data Warehouse â†’ Embeddings â†’ Vector DB â†’ RAG â†’ API â†’ Frontend â†’ Feedback Loop
```

---

## ğŸ”„ Pipeline Detallado Completo
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 1: INGESTA DE DATOS (Data Collection)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  [Spotify API] â”€â”€â”                                                          â”‚
â”‚  [Genius API]  â”€â”€â”¼â”€â”€â†’ [Cloud Function: ingestion] â†â”€â”€ [Cloud Scheduler]     â”‚
â”‚  [Last.fm API] â”€â”€â”˜         â”‚                              (Cada 6 horas)    â”‚
â”‚                            â”‚                                                â”‚
â”‚                            â–¼                                                â”‚
â”‚                   [Cloud Storage: RAW]                                      â”‚
â”‚                   gs://bucket/raw/                                          â”‚
â”‚                   â”œâ”€â”€ spotify_YYYYMMDD.json                                 â”‚
â”‚                   â”œâ”€â”€ genius_YYYYMMDD.json                                  â”‚
â”‚                   â””â”€â”€ lastfm_YYYYMMDD.json                                  â”‚
â”‚                            â”‚                                                â”‚
â”‚                            â–¼                                                â”‚
â”‚                   [BigQuery: Dataset RAW]                                   â”‚
â”‚                   â”œâ”€â”€ spotify_tracks                                        â”‚
â”‚                   â”œâ”€â”€ genius_lyrics                                         â”‚
â”‚                   â””â”€â”€ lastfm_tags                                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 2: TRANSFORMACIÃ“N (Data Cleaning & Feature Engineering)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  [BigQuery: RAW] â”€â”€â†’ [dbt Core/Cloud] â”€â”€â†’ [BigQuery: CLEAN]                 â”‚
â”‚                           â”‚                     â”‚                           â”‚
â”‚                           â”‚                     â”œâ”€â”€ tracks (unified)        â”‚
â”‚                           â”‚                     â”œâ”€â”€ track_features          â”‚
â”‚                           â”‚                     â”œâ”€â”€ lyrics_processed        â”‚
â”‚                           â”‚                     â””â”€â”€ tags_normalized         â”‚
â”‚                           â”‚                                                 â”‚
â”‚                           â””â”€â”€â†’ [Transformaciones dbt]                       â”‚
â”‚                                - DeduplicaciÃ³n                              â”‚
â”‚                                - NormalizaciÃ³n                              â”‚
â”‚                                - Feature engineering                        â”‚
â”‚                                - Agregaciones                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 3: EMBEDDINGS & VECTORIZACIÃ“N (Semantic Indexing)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  [BigQuery: CLEAN] â”€â”€â†’ [Cloud Run: embedding-service]                       â”‚
â”‚        â”‚                       â”‚                                            â”‚
â”‚        â”‚                       â”œâ”€â”€â†’ [Vertex AI: text-embedding-004]         â”‚
â”‚        â”‚                       â”‚    Genera embeddings de:                   â”‚
â”‚        â”‚                       â”‚    - Letras de canciones                   â”‚
â”‚        â”‚                       â”‚    - Descripciones                         â”‚
â”‚        â”‚                       â”‚    - Tags combinados                       â”‚
â”‚        â”‚                       â”‚                                            â”‚
â”‚        â”‚                       â–¼                                            â”‚
â”‚        â”‚              [Embeddings: Array[768]]                              â”‚
â”‚        â”‚                       â”‚                                            â”‚
â”‚        â”‚                       â–¼                                            â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ [Vertex AI Vector Search]                           â”‚
â”‚                         Index: music-embeddings                             â”‚
â”‚                         â””â”€â”€ 100K+ vectores indexados                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 4: SISTEMA DE RECOMENDACIÃ“N (Recommendation Engine)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  [Usuario Query] â”€â”€â†’ [Cloud Run: recommendation-service]                    â”‚
â”‚  "mÃºsica triste          â”‚                                                  â”‚
â”‚   pero energÃ©tica"       â”‚                                                  â”‚
â”‚                          â–¼                                                  â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚                   â”‚ Query Embedding â”‚                                       â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                          â”‚                                                  â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚         â”‚                â”‚                â”‚                                 â”‚
â”‚         â–¼                â–¼                â–¼                                 â”‚
â”‚  [Vector Search]  [Collaborative]  [Content-Based]                          â”‚
â”‚  Top 100          Filtering        Filtering                                â”‚
â”‚  candidatos       (User-Item)      (Audio features)                         â”‚
â”‚         â”‚                â”‚                â”‚                                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                          â–¼                                                  â”‚
â”‚                   [Hybrid Ranker]                                           â”‚
â”‚                   Combina seÃ±ales:                                          â”‚
â”‚                   - Similitud semÃ¡ntica                                     â”‚
â”‚                   - Popularidad                                             â”‚
â”‚                   - Historial usuario                                       â”‚
â”‚                   - Contexto temporal                                       â”‚
â”‚                          â”‚                                                  â”‚
â”‚                          â–¼                                                  â”‚
â”‚                   [Top 20 Candidatos]                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 5: RAG (Retrieval Augmented Generation)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  [Top 20 Candidatos] â”€â”€â†’ [RAG Pipeline]                                     â”‚
â”‚                               â”‚                                             â”‚
â”‚                               â–¼                                             â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                        â”‚  RETRIEVAL   â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                               â”‚                                             â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚              â”‚                â”‚                â”‚                            â”‚
â”‚              â–¼                â–¼                â–¼                            â”‚
â”‚      [Vector Search]   [BigQuery]      [User Context]                       â”‚
â”‚      Canciones         Reviews         Historial                            â”‚
â”‚      similares         Comentarios     Preferencias                         â”‚
â”‚              â”‚                â”‚                â”‚                            â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                               â–¼                                             â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                        â”‚ AUGMENTATION â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                               â”‚                                             â”‚
â”‚                     Contexto enriquecido:                                   â”‚
â”‚                     - Letras relevantes                                     â”‚
â”‚                     - Reviews positivos                                     â”‚
â”‚                     - Tags de usuarios                                      â”‚
â”‚                     - Canciones relacionadas                                â”‚
â”‚                               â”‚                                             â”‚
â”‚                               â–¼                                             â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                        â”‚  GENERATION  â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                               â”‚                                             â”‚
â”‚                               â–¼                                             â”‚
â”‚                     [Vertex AI: Gemini]                                     â”‚
â”‚                     Prompt:                                                 â”‚
â”‚                     "Usuario busca: {query}                                 â”‚
â”‚                      Canciones encontradas: {tracks}                        â”‚
â”‚                      Evidencia: {context}                                   â”‚
â”‚                      Genera explicaciÃ³n personalizada"                      â”‚
â”‚                               â”‚                                             â”‚
â”‚                               â–¼                                             â”‚
â”‚                   [Recomendaciones + Explicaciones]                         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        
                         
                          

## ğŸ¯ Uso

### Ejecutar ingesta local
```bash
cd ingestion
python main.py
```

## ğŸ“ Licencia

MIT






